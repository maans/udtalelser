<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Elevudtalelser (statisk)</title>
  <link rel="stylesheet" href="app.css" />
</head>
<body>
  <header class="topbar no-print">
    <div class="brand">
      <span class="dot"></span>
      <span>Elevudtalelser</span>
    </div>

    <nav class="tabs" aria-label="Navigation">
      <button id="tab-k" class="tab" data-tab="k" title="K-elever">üë§ <span>K-elever</span></button>
      <button id="tab-edit" class="tab" data-tab="edit" title="Redig√©r">‚úçÔ∏è <span>Redig√©r</span></button>
      <button id="tab-set" class="tab" data-tab="set" title="Indstillinger">‚öôÔ∏è <span>Indstillinger</span></button>
    </nav>

    <div class="status">
      <span id="statusText" class="statusText"></span>
    </div>
  </header>

  <main class="app">
    <!-- K-elever -->
    <section id="view-k" class="view">
      <div class="viewHeader">
        <h1>K-elever</h1>
        <p class="muted">Viser kun elever hvor Kontaktl√¶rer1 eller Kontaktl√¶rer2 matcher <b>‚ÄúJeg er‚Äù</b>.</p>
      </div>

      <div id="kMessage" class="callout"></div>
      <div id="kList" class="list"></div>
    </section>

    <!-- Redig√©r -->
    <section id="view-edit" class="view">
      <div class="viewHeader no-print">
        <h1>Redig√©r</h1>
        <div class="row gap wrap">
          <div class="pill" id="editStudentPill">Ingen elev valgt</div>
          <div class="pill muted" id="autosavePill"></div>
          <button class="btn no-print" id="btnPrint">üñ®Ô∏è Print / Gem som PDF</button>
        </div>
      </div>

      <div id="editMessage" class="callout no-print"></div>

      <div class="split">
        <div class="panel no-print">
          <details open class="fold">
            <summary>Elevudvikling</summary>
            <textarea id="txtElevudv" rows="8" placeholder="Skriv elevudvikling‚Ä¶"></textarea>
          </details>

          <details class="fold">
            <summary>Praktisk afsnit</summary>
            <textarea id="txtPraktisk" rows="7" placeholder="Skriv praktisk afsnit‚Ä¶"></textarea>
          </details>

          <details class="fold">
            <summary>Funktion i kontaktgruppen</summary>
            <textarea id="txtKgruppe" rows="7" placeholder="Skriv kontaktgruppe-afsnit‚Ä¶"></textarea>
          </details>

          <div class="card no-print">
            <div class="cardTitle">Elevens eget input (PDF/Word)</div>
            <div class="row gap wrap">
              <input id="fileStudentInput" type="file" accept=".pdf,.doc,.docx,.odt,.rtf,.txt" />
              <button id="btnClearStudentInput" class="btn ghost" type="button">Fjern</button>
            </div>
            <div id="studentInputMeta" class="muted small"></div>
            <div class="muted small">
              N√•r du v√¶lger en fil, √•bnes den i en ny fane. Appen gemmer kun filnavn + tidspunkt (ikke selve filen).
              <br/>Bem√¶rk: browseren kan ikke gen√•bne filen automatisk efter genstart ‚Äì men du kan v√¶lge den igen.
            </div>
          </div>
        </div>

        <div class="panel">
          <article id="preview" class="preview"></article>
        </div>
      </div>
    </section>

    <!-- Indstillinger -->
    <section id="view-set" class="view">
      <div class="viewHeader">
        <h1>Indstillinger</h1>
        <p class="muted">Alt gemmes lokalt i denne browser (localStorage). Ingen server.</p>
      </div>

      <div class="grid2">
        <!-- Venstre: System & Data -->
        <div class="card">
          <div class="cardTitle">Data & nulstil</div>
          <button id="btnReset" class="btn danger" type="button">üßπ Ryd alle lokale data (denne browser)</button>
          <div class="muted small" style="margin:.5rem 0 1rem 0">
            Sletter alle n√∏gler der starter med <code>udt_</code> og genstarter appen.
          </div>

          <div class="cardSubTitle">Elevliste (CSV) ‚Äì skal indl√¶ses f√∏rst</div>
          <input id="studentsFile" type="file" accept=".csv,.txt" />
          <div id="studentsStatus" class="muted small" style="margin-top:.35rem"></div>

          <details class="fold no-print" style="margin-top:.8rem">
            <summary>Accepterede kolonner (eksempler)</summary>
            <div class="muted small">
              <div><b>Prim√¶rt:</b> Fornavn, Efternavn, Unilogin, K√∏n, Kontaktl√¶rer1, Kontaktl√¶rer2, Klasse</div>
              <div><b>Uni-C:</b> Klasse, Fornavn, Efternavn, Uni-C brugernavn, K√∏n, Relationer-Kontaktl√¶rer-Navn, Relationer-Anden kontaktl√¶rer-Navn</div>
              <div>Appen mapper kolonner robust (case-insensitivt, trim, accepter Unilogin/Uni-C brugernavn).</div>
            </div>
          </details>

          <div class="divider"></div>

          <div class="cardSubTitle">Import af fagl√¶rer-CSV‚Äôer (for kontaktl√¶rere)</div>
          <div class="grid3">
            <div class="field">
              <label>sang_marks.csv</label>
              <input id="importSang" type="file" accept=".csv,.txt" />
            </div>
            <div class="field">
              <label>gym_marks.csv</label>
              <input id="importGym" type="file" accept=".csv,.txt" />
            </div>
            <div class="field">
              <label>elevraad_marks.csv</label>
              <input id="importElevraad" type="file" accept=".csv,.txt" />
            </div>
          </div>
          <div id="importStatus" class="muted small"></div>
        </div>

        <!-- H√∏jre: Identitet + skabeloner -->
        <div class="card">
          <div class="cardTitle">Navne og periode</div>

          <div class="field">
            <label>Forstandernavn</label>
            <div class="row gap">
              <input id="forstanderName" type="text" />
              <button id="btnToggleForstander" class="btn ghost" type="button" title="L√•s op / l√•s">‚úèÔ∏è</button>
            </div>
          </div>

          <details class="fold" id="schoolTextFold">
            <summary>Skolens standardtekst</summary>
            <div class="row gap wrap" style="margin:.5rem 0">
              <button id="btnToggleSchoolText" class="btn ghost" type="button">‚úèÔ∏è Redig√©r</button>
              <button id="btnRestoreSchoolText" class="btn ghost" type="button">‚Ü©Ô∏è Gendan standard</button>
            </div>
            <textarea id="schoolText" rows="10"></textarea>
          </details>

          <div class="field">
            <label>Jeg er (initialer eller navn)</label>
            <input id="meInput" type="text" placeholder="fx MM, RD, MTP eller fuldt navn" />
            <div class="muted small">Fortolkes via alias-map og bruges til filter af K-elever.</div>
          </div>

          <div class="field">
            <label>Skole√•r (slut-√•r)</label>
            <input id="schoolYearEnd" type="number" min="2000" max="2100" step="1" />
          </div>

          <div class="field">
            <label>Periode fra (auto)</label>
            <input id="periodFrom" type="text" readonly />
          </div>

          <div class="field">
            <label>Dato m√•ned/√•r (auto)</label>
            <input id="dateMonthYear" type="text" readonly />
          </div>

          <div class="field">
            <label>Kontaktgruppe antal (auto)</label>
            <input id="contactCount" type="text" readonly />
          </div>

          <details class="fold" id="templateFold">
            <summary>Udtalelses-skabelon (med placeholders)</summary>
            <div class="row gap wrap" style="margin:.5rem 0">
              <button id="btnToggleTemplate" class="btn ghost" type="button">‚úèÔ∏è Redig√©r</button>
              <button id="btnRestoreTemplate" class="btn ghost" type="button">‚Ü©Ô∏è Gendan standard</button>
            </div>
            <textarea id="templateText" rows="14"></textarea>
            <div class="muted small">Brug placeholders som <code>{{ELEV_FORNAVN}}</code>, <code>{{SANG_AFSNIT}}</code>, <code>{{PRAKTISK_AFSNIT}}</code> osv.</div>
          </details>
        </div>
      </div>

      <div class="card no-print" style="margin-top:1rem">
        <div class="cardTitle">Fagl√¶rer-arbejde (producer CSV til deling)</div>

        <div class="row gap wrap">
          <label class="muted small">Type</label>
          <select id="marksType">
            <option value="sang">Sang</option>
            <option value="gym">Gym/roller</option>
            <option value="elevraad">Elevr√•d</option>
          </select>

          <label class="muted small">Find elev</label>
          <input id="marksSearch" type="text" placeholder="S√∏g p√• navn‚Ä¶" class="search" />

          <button id="btnExportMarks" class="btn" type="button">‚¨áÔ∏è Eksport√©r CSV</button>
        </div>

        <div id="marksLegend" class="muted small" style="margin-top:.6rem"></div>
        <div id="marksTableWrap" class="tableWrap"></div>
      </div>
    </section>
  </main>

  <footer class="footer no-print">
    <span class="muted small">Statisk app til GitHub Pages ¬∑ localStorage-prefix: <code>udt_</code></span>
  </footer>

  <script src="app.js"></script>
</body>
</html>
